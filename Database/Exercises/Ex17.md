SELECT SM.SID, SM.SNAME, NVL(Sum(SD.QUANTITY * P.PRICE),0) Tamount, NVL(Sum(SD.QUANTITY * P.PRICE * P.DISCOUNT/100),0) Tdiscount
FROM Salesman SM
LEFT OUTER JOIN Sale S ON SM.SID = S.SID
LEFT OUTER JOIN Saledetail SD on S.SALEID = SD.SALEID
LEFT OUTER JOIN Product P ON SD.PRODID = P.PRODID
GROUP BY SM.SID, SM.Sname